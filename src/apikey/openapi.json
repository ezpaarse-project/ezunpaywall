{
  "openapi": "3.0.0",
  "info": {
    "description": "The Apikey service is reserved for the administrator, it allows to manage the API keys",
    "version": "1.0.0",
    "title": "Apikey service",
    "contact": {
      "email": "ezteam@couperin.org",
      "name": "ezTeam"
    },
    "license": {
      "name": "CeCILL 2.1",
      "url": "http://www.cecill.info/licences/Licence_CeCILL_V2.1-en.html"
    }
  },
  "tags": [
    {
      "name": "apikey"
    },
    {
      "name": "ping"
    }
  ],
  "paths": {
    "/apikey/keys/${apikey}": {
      "get": {
        "tags": [
          "apikey"
        ],
        "summary": "Get config of apikey",
        "operationId": "get-apikey-keys-$-apikey",
        "description": "Get config of apikey",
        "parameters": [
          {
            "in": "path",
            "name": "apikey",
            "description": "apikey",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "config of apikey",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "apikey": {
                      "type": "string",
                      "default": "azerty"
                    },
                    "name": {
                      "type": "string",
                      "default": "john doe"
                    },
                    "attributes": {
                      "type": "array",
                      "items": {
                        "type": "string",
                        "default": "*"
                      }
                    },
                    "access": {
                      "type": "array",
                      "items": {
                        "type": "string",
                        "default": "graphql"
                      }
                    },
                    "allowed": {
                      "type": "boolean"
                    }
                  }
                }
              }
            }
          }
        }
      },
      "put": {
        "tags": [
          "apikey"
        ],
        "summary": "Update apikey",
        "operationId": "put-apikeys-keys-$-apikey",
        "description": "Update apikey",
        "parameters": [
          {
            "in": "path",
            "name": "apikey",
            "description": "apikey",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "update apikey",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "apikey": {
                      "type": "string",
                      "default": "azerty"
                    },
                    "name": {
                      "type": "string",
                      "default": "john doe"
                    },
                    "attributes": {
                      "type": "array",
                      "items": {
                        "type": "string",
                        "default": "*"
                      }
                    },
                    "access": {
                      "type": "array",
                      "items": {
                        "type": "string",
                        "default": "graphql"
                      }
                    },
                    "allowed": {
                      "type": "boolean"
                    }
                  }
                },
                "examples": {
                  "John Doe apikey": {
                    "value": {
                      "apikey": "azerty",
                      "name": "john doe",
                      "attributes": [
                        "*"
                      ],
                      "access": [
                        "graphql"
                      ],
                      "allowed": true
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Bad Request",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "message": {
                      "type": "string"
                    }
                  },
                  "x-examples": {
                    "example-1": {
                      "message": "\"name\" is required"
                    }
                  }
                },
                "examples": {
                  "Name is required": {
                    "value": {
                      "message": "\"name\" is required"
                    }
                  }
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Not-authorized"
          }
        },
        "security": [
          {
            "x-api-key": []
          }
        ]
      },
      "delete": {
        "tags": [
          "apikey"
        ],
        "summary": "Delete apikey",
        "operationId": "delete-apikey-keys-$-apikey",
        "description": "Delete apikey",
        "parameters": [
          {
            "in": "path",
            "name": "apikey",
            "description": "apikey",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "apikey deleted"
          },
          "401": {
            "$ref": "#/components/responses/Not-authorized"
          }
        },
        "security": [
          {
            "x-api-key": []
          }
        ]
      }
    },
    "/apikey/keys": {
      "get": {
        "tags": [
          "apikey"
        ],
        "summary": "Get all config of all apikey",
        "operationId": "get-apikey-keys",
        "description": "Get all config of all apikey",
        "responses": {
          "200": {
            "description": "update apikey",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "properties": {
                      "apikey": {
                        "type": "string",
                        "default": "azerty"
                      },
                      "name": {
                        "type": "string",
                        "default": "john doe"
                      },
                      "attributes": {
                        "type": "array",
                        "items": {
                          "type": "string",
                          "default": "*"
                        }
                      },
                      "access": {
                        "type": "array",
                        "items": {
                          "type": "string",
                          "default": "graphql"
                        }
                      },
                      "allowed": {
                        "type": "boolean"
                      }
                    }
                  }
                },
                "examples": {
                  "John doe apikey": {
                    "value": [
                      {
                        "apikey": "azerty",
                        "name": "john doe",
                        "attributes": [
                          "*"
                        ],
                        "access": [
                          "graphql"
                        ],
                        "allowed": true
                      }
                    ]
                  }
                }
              },
              "apikey of John Doe": {
                "examples": {
                  "response": {
                    "value": [
                      {
                        "apikey": "azerty123456",
                        "name": "John Doe",
                        "attributes": [
                          "*"
                        ],
                        "access": [
                          "graphql"
                        ],
                        "allowed": true
                      }
                    ]
                  }
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Not-authorized"
          }
        },
        "security": [
          {
            "x-api-key": []
          }
        ]
      },
      "delete": {
        "tags": [
          "apikey"
        ],
        "summary": "Delete all apikey",
        "operationId": "delete-apikey-keys",
        "description": "Delete all apikey",
        "responses": {
          "204": {
            "description": "all apikey are deleted"
          },
          "401": {
            "$ref": "#/components/responses/Not-authorized"
          }
        },
        "security": [
          {
            "x-api-key": []
          }
        ]
      },
      "post": {
        "tags": [
          "apikey"
        ],
        "summary": "Create apikey",
        "operationId": "post-apikey-keys",
        "description": "Create new apikey",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "name": {
                    "type": "string"
                  },
                  "attributes": {
                    "type": "array",
                    "items": {
                      "type": "string"
                    }
                  },
                  "access": {
                    "type": "array",
                    "items": {
                      "type": "string"
                    }
                  },
                  "allowed": {
                    "type": "boolean"
                  }
                }
              }
            }
          },
          "description": "config for apikey",
          "required": true
        },
        "responses": {
          "200": {
            "description": "update apikey",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "apikey": {
                      "type": "string",
                      "default": "azerty"
                    },
                    "name": {
                      "type": "string",
                      "default": "john doe"
                    },
                    "attributes": {
                      "type": "array",
                      "items": {
                        "type": "string",
                        "default": "*"
                      }
                    },
                    "access": {
                      "type": "array",
                      "items": {
                        "type": "string",
                        "default": "graphql"
                      }
                    },
                    "allowed": {
                      "type": "boolean"
                    }
                  }
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Not-authorized"
          }
        },
        "security": [
          {
            "x-api-key": []
          }
        ]
      }
    },
    "/apikey/keys/load": {
      "post": {
        "tags": [
          "apikey"
        ],
        "summary": "Load apikey",
        "operationId": "post-apikeys-keys-load",
        "description": "Load apikey",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "type": "object",
                  "properties": {
                    "apikey": {
                      "type": "string"
                    },
                    "name": {
                      "type": "string"
                    },
                    "attributes": {
                      "type": "array",
                      "items": {
                        "type": "string"
                      }
                    },
                    "access": {
                      "type": "array",
                      "items": {
                        "type": "string"
                      }
                    },
                    "allowed": {
                      "type": "boolean"
                    }
                  }
                },
                "x-examples": {
                  "example-1": [
                    {
                      "apikey": "string",
                      "name": "string",
                      "attributes": [
                        "string"
                      ],
                      "access": [
                        "string"
                      ],
                      "allowed": true
                    }
                  ]
                }
              },
              "examples": {
                "example-1": {
                  "value": [
                    {
                      "apikey": "string",
                      "name": "string",
                      "attributes": [
                        "string"
                      ],
                      "access": [
                        "string"
                      ],
                      "allowed": true
                    }
                  ]
                }
              }
            }
          },
          "description": "apikeys",
          "required": true
        },
        "responses": {
          "204": {
            "description": "all apikey are loaded"
          },
          "401": {
            "$ref": "#/components/responses/Not-authorized"
          }
        },
        "security": [
          {
            "x-api-key": []
          }
        ]
      }
    },
    "/apikey": {
      "get": {
        "summary": "Name of service",
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "Success": {
                "examples": {
                  "response": {
                    "value": {
                      "message": "apikey service"
                    }
                  }
                }
              }
            }
          }
        },
        "operationId": "get-apikey",
        "description": "Name of service",
        "tags": [
          "ping"
        ]
      },
      "parameters": []
    },
    "/apikey/ping": {
      "get": {
        "summary": "Ping apikey service",
        "operationId": "get-apikey-ping",
        "description": "Ping apikey service",
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "Success": {
                "examples": {
                  "response": {
                    "value": true
                  }
                }
              }
            }
          }
        },
        "tags": [
          "ping"
        ]
      }
    },
    "/apikey/ping/redis": {
      "get": {
        "summary": "Ping redis service",
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "Success": {
                "examples": {
                  "response": {
                    "value": {
                      "message": true
                    }
                  }
                }
              },
              "Error": {
                "examples": {
                  "response": {
                    "value": {
                      "message": "Cannot ping redis",
                      "stackTrace": ""
                    }
                  }
                }
              }
            }
          }
        },
        "operationId": "get-apikey-ping-redis",
        "description": "Ping redis service",
        "tags": [
          "ping"
        ]
      }
    }
  },
  "externalDocs": {
    "description": "Find out more about Swagger",
    "url": "http://swagger.io"
  },
  "components": {
    "responses": {
      "Not-authorized": {
        "description": "Not authorized",
        "content": {
          "Not authorized": {
            "examples": {
              "response": {
                "value": {
                  "message": "Not authorized"
                }
              }
            }
          }
        },
        "headers": {
          "redis-password": {
            "schema": {
              "type": "string"
            },
            "description": "redis password"
          }
        }
      }
    },
    "securitySchemes": {
      "x-api-key": {
        "name": "API Key",
        "type": "apiKey",
        "in": "header"
      }
    }
  }
}